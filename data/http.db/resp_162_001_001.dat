317c
reloadSlots0 && reloadSlots0([{"slot": "4847", "banner": "25056413", "html": "\r\n\r\n\r\n\r\n\t\r\n\r\n{\r\n  \r\n\t\"img\": \"https:\/\/r.mradx.net\/img\/E7\/C9EDFC.jpg\",\r\n\t\"href\": \"https:\/\/r.mail.ru\/n245313117?sz=&rnd=104734549\"\r\n\t\r\n\t, \"title\": [\r\n\t\t\"\\u0415\\u0434\\u0430 \\u0441 \\u043f\\u044b\\u043b\\u0443, \\u0441 \\u0436\\u0430\\u0440\\u0443\"\r\n  \t\r\n\t]\r\n\t\r\n\t\r\n\t, \"text\":[\r\n\t\t\r\n\t\t\t\"\\u0417\\u0430\\u043a\\u0430\\u0436\\u0438\\u0442\\u0435 \\u0435\\u0434\\u0443 \\u0443 \\u043d\\u0430\\u0441, \\u0438 \\u043e\\u043d\\u0430 \\u043f\\u0440\\u0438\\u0435\\u0434\\u0435\\u0442 \\u043a \\u0432\\u0430\\u043c \\u043e\\u0431\\u0436\\u0438\\u0433\\u0430\\u044e\\u0449\\u0435 \\u0433\\u043e\\u0440\\u044f\\u0447\\u0435\\u0439\"\r\n\t\t\r\n\t\t\r\n\t]\r\n\t\r\n\t\r\n\t\t, \"marker\":\r\n\t\t\t\r\n\t\t\t\t\"\\u041e\\u041e\\u041e &laquo;\\u0414\\u0435\\u043b\\u0438\\u0432\\u0435\\u0440\\u0438 \\u041a\\u043b\\u0430\\u0431&raquo;, \\u041e\\u0413\\u0420\\u041d: 1097746360568\"\r\n\t\t\t\r\n\t\r\n\t\r\n\t\t, \"pixels\": [\r\n\t\t\r\n\t\t\t\r\n\t\t\r\n\t\t]\r\n\t\r\n}\r\n"}, {"slot": "4499", "banner": "25371845", "html": "\r\n<div class=\"mailru-visibility-check\"> <span class=\"mailru-visibility-check-counter\" data-counter=\"https:\/\/rs.mail.ru\/e25371845.gif?e=1\" style=\"display:none\"><\/span> <img src=\"https:\/\/rs.mail.ru\/d25371845.gif?sz=&amp;rnd=124313833&ts=1489149188&sz=\" style=\"width:0;height:0;position:absolute;visibility:hidden;\" alt=\"\"\/>\r\n \r\n\r\n<iframe src=\"\/\/r.mradx.net\/h5\/78\/10F3C769\/1789831D4C.html?data=CMXJjAwQ2KLk0gMdBJ3CWCgEoAHst8iyBbgBRpAD7LfIsmXCAgLVYA&amp;link1=247789916\" width=\"300\" height=\"300\" marginwidth=\"0\" marginheight=\"0\" hspace=\"0\" vspace=\"0\" frameborder=\"0\" scrolling=\"no\" bordercolor=\"#000000\" style=\"display:block;visibility:visible\"><\/iframe>\r\n\r\n\r\n\r\n\r\n <\/div>\n<script>\r\ntry{\r\n  (function(w,d,prefix){\r\n  \r\n  w.RB = w.RB && w.RB.v && w.RB.v === 1 ? w.RB : (function() {\r\n\t\t\tvar\r\n\t\t\t\/\/ main flag,\r\n\t\t\tenabled = !1,\r\n \r\n\t\t\t\t\/\/ old opera focus flag\r\n\t\t\t\tfocused = !0,\r\n \r\n\t\t\t\t\/\/ banners to inspect\r\n\t\t\t\tbanners = {},\r\n \r\n\t\t\t\t\/\/ shortcuts\r\n\t\t\t\te = d.documentElement,\r\n \r\n\t\t\t\tVE = (d.mozVisibilityState ? \"mozvisibilitychange\" : d.webkitVisibilityState ? \"webkitvisibilitychange\" : d.visibilityState ? \"visibilitychange\" : \"\"),\r\n \r\n\t\t\t\t\/\/ lastTimeStamp = 0,\r\n \r\n\t\t\t\t\/\/ timing\r\n\t\t\t\ttm;\r\n \r\n\t\t\t\/\/ handlers\r\n \r\n\t\t\tfunction onFocusIn() {\r\n\t\t\t\tfocused = !0;\r\n\t\t\t\tC(!0);\r\n\t\t\t}\r\n \r\n\t\t\tfunction onFocusOut() {\r\n\t\t\t\tfocused = !1;\r\n\t\t\t}\r\n \r\n\t\t\t\/\/ using visibility could have profits when tab is not\r\n \r\n\t\t\tfunction onVisibilityChange() {\r\n\t\t\t\tif (!d.hidden) onFocusIn()\r\n\t\t\t\telse onFocusOut()\r\n\t\t\t}\r\n \r\n\t\t\tfunction onWindowScroll() {\r\n\t\t\t\tC();\r\n\t\t\t}\r\n \r\n\t\t\tfunction onWindowResize() {\r\n\t\t\t\tC()\r\n\t\t\t}\r\n \r\n \r\n\t\t\t\/\/ I &ndash; inspect\r\n \r\n\t\t\tfunction I(bannerObject, id) {\r\n\t\t\t\tif (Object.prototype.toString.call(bannerObject) === '[object Array]'){\r\n\t\t\t\t\tClear();\r\n\t\t\t\t\tvar k = bannerObject.length - 1;\r\n\t\t\t\t\tfor (; k >= 0; k--) {\r\n\t\t\t\t\t\tI(bannerObject[k]);\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\/\/ bannerObject contains bannerObject.el and bannerObject.pixels\r\n\t\t\t\tif (!bannerObject.el.id) {\r\n\t\t\t\t\tid = prefix + (new Date().getTime()) + (Math.round(Math.random()*1E6));\r\n\t\t\t\t\tbannerObject.el.id = id;\r\n\t\t\t\t}\r\n \r\n\t\t\t\tid = bannerObject.el.id;\r\n \r\n\t\t\t\t\/\/ lastTimeStamp = new Date().getTime();\r\n\t\t\t\t\/\/ adding the banner container to storage\r\n\t\t\t\tif (!banners[id]) {\r\n\t\t\t\t\tbanners[id] = {\r\n\t\t\t\t\t\tc: bannerObject.el,\r\n\t\t\t\t\t\tpx: bannerObject.pixels\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n \r\n\t\t\t\t\/\/ enabling anyway\r\n\t\t\t\ton();\r\n\t\t\t\tC(true);\r\n\t\t\t}\r\n \r\n \r\n\t\t\t\/\/ C &ndash; check viewability of banner with t, timeout after loading\r\n \r\n\t\t\tfunction C(t) {\r\n\t\t\t\tfor (var id in banners) {\r\n\t\t\t\t\tif (banners[id] && getVA(banners[id].c) >= 50 && hasFocus() && !banners[id].t) {\r\n\t\t\t\t\t\t(function(_id) {\r\n\t\t\t\t\t\t\tbanners[_id].t = setTimeout(function() {\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tP(_id)\r\n\t\t\t\t\t\t\t\t} catch (e) {}\r\n\t\t\t\t\t\t\t}, 1E3)\r\n\t\t\t\t\t\t}(id));\r\n\t\t\t\t\t} else if (banners[id] && getVA(banners[id].c) < 50) {\r\n\t\t\t\t\t\tif (banners[id].t) {\r\n\t\t\t\t\t\t\tclearTimeout(banners[id].t);\r\n\t\t\t\t\t\t\tdelete banners[id].t;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (banners[id] && !hasFocus()) {\r\n\t\t\t\t\t\tif (banners[id].t) {\r\n\t\t\t\t\t\t\tclearTimeout(banners[id].t);\r\n\t\t\t\t\t\t\tdelete banners[id].t;\r\n\t\t\t\t\t\t\tclearTimeout(tm);\r\n\t\t\t\t\t\t\tt = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!banners[id]) {\r\n\t\t\t\t\t\tCL(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (t) {\r\n\t\t\t\t\tclearTimeout(tm);\r\n\t\t\t\t\ttm = setTimeout(function() {\r\n\t\t\t\t\t\tC(!0)\r\n\t\t\t\t\t}, 3e2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n \r\n\t\t\t\/\/ CL &ndash; Clear timers and stop listeners\r\n \r\n\t\t\tfunction CL(id, onlyTM) {\r\n\t\t\t\tif (id && banners[id]) {\r\n\t\t\t\t\tclearTimeout(banners[id].t);\r\n\t\t\t\t\tbanners[id].t = null;\r\n\t\t\t\t\tif (!onlyTM) {\r\n\t\t\t\t\t\tbanners[id].c = null;\r\n\t\t\t\t\t\tdelete banners[id];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tclearTimeout(tm);\r\n\t\t\t\ttm = null;\r\n\t\t\t\tfor (var id in banners) {\r\n\t\t\t\t\tif (banners[id].t) {\r\n\t\t\t\t\t\tCL(id, !0)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n \r\n\t\t\tfunction Clear() {\r\n\t\t\t\tfor (var id in banners) {\r\n\t\t\t\t\tCL(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n \r\n \r\n\t\t\t\/\/ P &ndash; pixel to send\r\n \r\n\t\t\tfunction P(id, obj, cnt) {\r\n\t\t\t\tif (!G(id)) {\r\n\t\t\t\t\tCL(id);\r\n \r\n\t\t\t\t\t\/\/ banner removed\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n \r\n\t\t\t\tif (banners[id]) {\r\n\t\t\t\t\tobj = banners[id].c;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n \r\n\t\t\t\tif (!hasFocus()) {\r\n\t\t\t\t\tCL(id, !0);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (getVA(obj) < 50) {\r\n\t\t\t\t\tCL(id, !0);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n \r\n\t\t\t\tfor (cnt = banners[id].px.length - 1; cnt >= 0; cnt--) {\r\n\t\t\t\t\tnew Image().src = banners[id].px[cnt];\r\n\t\t\t\t};\r\n \r\n\t\t\t\t\/\/ remove banner from storage of inspectable items\r\n\t\t\t\tCL(id);\r\n\t\t\t\t\/\/ turn listeners off if banners are not present\r\n\t\t\t\tif (!l(banners)) off();\r\n\t\t\t}\r\n \r\n\t\t\tfunction hasFocus() {\r\n\t\t\t\tif (!VE && typeof d.hasFocus === \"function\") focused = d.hasFocus();\r\n\t\t\t\treturn focused;\r\n\t\t\t}\r\n \r\n\t\t\tfunction getVA(obj) {\r\n\t\t\t\tvar R = {};\r\n\t\t\t\tR.w = R.h = Infinity;\r\n\t\t\t\tif (!isNaN(d.body.clientWidth) && d.body.clientWidth > 0) {\r\n\t\t\t\t\tR['w'] = d.body.clientWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (!isNaN(d.body.clientHeight) && d.body.clientHeight > 0) {\r\n\t\t\t\t\tR['h'] = d.body.clientHeight;\r\n\t\t\t\t}\r\n\t\t\t\tif ( !! e && !! e.clientWidth && !isNaN(e.clientWidth)) {\r\n\t\t\t\t\tR['w'] = e.clientWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif ( !! e && !! e.clientHeight && !isNaN(e.clientHeight)) {\r\n\t\t\t\t\tR['h'] = e.clientHeight;\r\n\t\t\t\t}\r\n\t\t\t\tif ( !! w.innerWidth && !isNaN(w.innerWidth)) {\r\n\t\t\t\t\tR['w'] = Math.min(R['w'], w.innerWidth);\r\n\t\t\t\t}\r\n\t\t\t\tif ( !! w.innerHeight && !isNaN(w.innerHeight)) {\r\n\t\t\t\t\tR['h'] = Math.min(R['h'], w.innerHeight);\r\n\t\t\t\t}\r\n\t\t\t\tif (R.h == Infinity || R.h == Infinity) {\r\n\t\t\t\t\tR = {\r\n\t\t\t\t\t\t\"E\": \":-(\"\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar r = obj.getClientRects()[0];\r\n\t\t\t\t\tif (!r) {\r\n\t\t\t\t\t\tR = {\r\n\t\t\t\t\t\t\t\"p\": 0\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn R;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tR.t = r.top;\r\n\t\t\t\t\tR.b = r.bottom;\r\n\t\t\t\t\tR.l = r.left;\r\n\t\t\t\t\tR.r = r.right;\r\n\t\t\t\t\tif (r.bottom < 0 || r.right < 0 || r.top > R.clientHeight || r.left > R.clientWidth) {\r\n\t\t\t\t\t\tR = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar totalObjectArea = (r.right - r.left) * (r.bottom - r.top),\r\n\t\t\t\t\t\t\txMin = Math.ceil(Math.max(0, r.left)),\r\n\t\t\t\t\t\t\txMax = Math.floor(Math.min(R.w, r.right)),\r\n\t\t\t\t\t\t\tyMin = Math.ceil(Math.max(0, r.top)),\r\n\t\t\t\t\t\t\tyMax = Math.floor(Math.min(R.h, r.bottom)),\r\n\t\t\t\t\t\t\tvisibleObjectArea = (xMax - xMin) * (yMax - yMin);\r\n\t\t\t\t\t\tR = Math.round(visibleObjectArea \/ totalObjectArea * 100);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn R;\r\n\t\t\t}\r\n \r\n\t\t\t\/** LISTENERS SWITCHERS **\/\r\n \r\n\t\t\tfunction on() {\r\n\t\t\t\tif (enabled) return;\r\n\t\t\t\tev(w, 'resize', onWindowResize);\r\n\t\t\t\tev(w, 'scroll', onWindowScroll);\r\n\t\t\t\tif (VE) ev(d, VE, onVisibilityChange);\r\n\t\t\t\telse {\r\n\t\t\t\t\tev(w, 'blur', onFocusOut);\r\n\t\t\t\t\tev(w, 'focus', onFocusIn);\r\n\t\t\t\t}\r\n\t\t\t\tenabled = true;\r\n\t\t\t}\r\n \r\n\t\t\tfunction off() {\r\n\t\t\t\trm(w, 'resize', onWindowResize);\r\n\t\t\t\trm(w, 'scroll', onWindowScroll);\r\n\t\t\t\tif (VE) rm(d, VE, onVisibilityChange);\r\n\t\t\t\trm(w, 'focus', onFocusIn);\r\n\t\t\t\trm(w, 'blur', onFocusOut);\r\n\t\t\t\tclearTimeout(tm);\r\n\t\t\t\tenabled = false;\r\n\t\t\t}\r\n \r\n\t\t\t\/** UTILS **\/\r\n\t\t\t\/\/ G - get element by ID;\r\n \r\n\t\t\tfunction G(E) {\r\n\t\t\t\treturn d.getElementById(E)\r\n\t\t\t}\r\n\t\t\t\/\/ ev - EVent to handle\r\n \r\n\t\t\tfunction ev(elem, eventName, callback) {\r\n\t\t\t\telem.addEventListener ? elem.addEventListener(eventName, callback, !1) : elem.attachEvent && elem.attachEvent(\"on\" + eventName, callback)\r\n\t\t\t}\r\n \r\n\t\t\tfunction rm(elem, eventName, callback) {\r\n\t\t\t\telem.removeEventListener ? elem.removeEventListener(eventName, callback, !1) : elem.detachEvent && elem.detachEvent(\"on\" + eventName, callback)\r\n\t\t\t}\r\n\t\t\t\/\/ obj length\r\n \r\n\t\t\tfunction l(obj) {\r\n\t\t\t\tvar s = 0,\r\n\t\t\t\t\tkey;\r\n\t\t\t\tfor (key in obj) {\r\n\t\t\t\t\tif (obj.hasOwnProperty(key)) s++\r\n\t\t\t\t}\r\n\t\t\t\treturn s;\r\n\t\t\t}\r\n \r\n\t\t\t\/** PUBLIC INTERFACE **\/\r\n \r\n\t\t\treturn {\r\n\t\t\t\tI: I\r\n\t\t\t\t\/\/ debug\r\n\t\t\t\t\/\/ , banners: banners\r\n\t\t\t\t,v : 1\r\n\t\t\t}\r\n\t\t}());\r\n  \r\n}(window, document, 'mailru'))}catch(e){}\r\n<\/script><script>\r\n  (function(prefix){\r\n    try{\r\n      \r\n      function getAdsContainers() {\r\n  \t\t\tvar ADS_CLASS = prefix + '-visibility-check',\r\n  \t\t\t\tADS_COUNTER_CLASS = ADS_CLASS + '-counter',\r\n  \t\t\t\tCOUNTER_ATTR = 'data-counter',\r\n  \t\t\t\tcontainers = [],\r\n  \t\t\t\tcountables = [],\r\n  \t\t\t\ti, k, counters, _counter;\r\n   \r\n  \t\t\tcontainers = getByClass(document, ADS_CLASS);\r\n  \t\t\tfor (i = containers.length - 1; i >= 0; i--) {\r\n  \t\t\t\tvar counters = getByClass(containers[i], ADS_COUNTER_CLASS, 'span');\r\n  \t\t\t\t_counter = containers[i].getAttribute(COUNTER_ATTR);\r\n  \t\t\t\tcountables[i] = {\r\n  \t\t\t\t\tel: containers[i],\r\n  \t\t\t\t\tpixels: []\r\n  \t\t\t\t};\r\n  \t\t\t\tif (_counter) countables[i].pixels.push(_counter);\r\n  \t\t\t\tfor (k = counters.length - 1; k >= 0; k--) {\r\n  \t\t\t\t\t_counter = counters[k].getAttribute(COUNTER_ATTR);\r\n  \t\t\t\t\tif (_counter && counters[k].parentNode === countables[i].el) countables[i].pixels.push(_counter);\r\n  \t\t\t\t}\r\n  \t\t\t\tif (!countables[i].pixels.length) countables.splice(i, 1);\r\n  \t\t\t}\r\n   \r\n  \t\t\treturn countables;\r\n  \t\t}\r\n   \r\n  \t\tfunction getByClass(parent, childClassName, tagName) {\r\n  \t\t\tif (parent.getElementsByClassName) {\r\n  \t\t\t\treturn parent.getElementsByClassName(childClassName);\r\n  \t\t\t} else if (parent.querySelectorAll) {\r\n   \r\n  \t\t\t\treturn parent.querySelectorAll('.' + childClassName);\r\n  \t\t\t} else {\r\n  \t\t\t\tvar els = [];\r\n  \t\t\t\tvar tmp = parent.getElementsByTagName(tagName ? tagName : \"*\");\r\n  \t\t\t\tvar regex = new RegExp(\"(^|\\s)\" + childClassName + \"(\\s|$)\");\r\n  \t\t\t\tfor (var i = 0; i < tmp.length; i++) {\r\n  \t\t\t\t\tif (regex.test(tmp[i].className)) {\r\n  \t\t\t\t\t\tels.push(tmp[i]);\r\n  \t\t\t\t\t}\r\n  \t\t\t\t}\r\n  \t\t\t\treturn els;\r\n  \t\t\t}\r\n  \t\t}\r\n   \r\n  \t\tRB.I(getAdsContainers());\r\n      \r\n    }catch(e){}\r\n  }('mailru'))\r\n<\/script>"}])

0

